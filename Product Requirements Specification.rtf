{\rtf1\ansi\ansicpg1252\cocoartf2864
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\froman\fcharset0 Times-Bold;\f1\froman\fcharset0 Times-Roman;\f2\fmodern\fcharset0 Courier;
\f3\fmodern\fcharset0 Courier-Bold;\f4\froman\fcharset0 Times-Italic;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;\red109\green109\blue109;}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0;\cssrgb\c50196\c50196\c50196;}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid1}
{\list\listtemplateid2\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid2}
{\list\listtemplateid3\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid3}
{\list\listtemplateid4\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid301\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid4}
{\list\listtemplateid5\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid5}
{\list\listtemplateid6\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid6}
{\list\listtemplateid7\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid7}
{\list\listtemplateid8\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid8}
{\list\listtemplateid9\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid9}
{\list\listtemplateid10\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid10}
{\list\listtemplateid11\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid11}
{\list\listtemplateid12\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid12}
{\list\listtemplateid13\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid13}
{\list\listtemplateid14\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid14}
{\list\listtemplateid15\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid15}
{\list\listtemplateid16\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid16}
{\list\listtemplateid17\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid17}
{\list\listtemplateid18\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid18}
{\list\listtemplateid19\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid19}
{\list\listtemplateid20\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid1902\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid20}
{\list\listtemplateid21\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid21}
{\list\listtemplateid22\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid22}
{\list\listtemplateid23\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid23}
{\list\listtemplateid24\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid24}
{\list\listtemplateid25\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid25}
{\list\listtemplateid26\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid2502\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid26}
{\list\listtemplateid27\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid27}
{\list\listtemplateid28\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid28}
{\list\listtemplateid29\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid29}
{\list\listtemplateid30\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid30}
{\list\listtemplateid31\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid31}
{\list\listtemplateid32\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid32}
{\list\listtemplateid33\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid33}
{\list\listtemplateid34\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid34}
{\list\listtemplateid35\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid35}
{\list\listtemplateid36\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid3501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid36}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}{\listoverride\listid2\listoverridecount0\ls2}{\listoverride\listid3\listoverridecount0\ls3}{\listoverride\listid4\listoverridecount0\ls4}{\listoverride\listid5\listoverridecount0\ls5}{\listoverride\listid6\listoverridecount0\ls6}{\listoverride\listid7\listoverridecount0\ls7}{\listoverride\listid8\listoverridecount0\ls8}{\listoverride\listid9\listoverridecount0\ls9}{\listoverride\listid10\listoverridecount0\ls10}{\listoverride\listid11\listoverridecount0\ls11}{\listoverride\listid12\listoverridecount0\ls12}{\listoverride\listid13\listoverridecount0\ls13}{\listoverride\listid14\listoverridecount0\ls14}{\listoverride\listid15\listoverridecount0\ls15}{\listoverride\listid16\listoverridecount0\ls16}{\listoverride\listid17\listoverridecount0\ls17}{\listoverride\listid18\listoverridecount0\ls18}{\listoverride\listid19\listoverridecount0\ls19}{\listoverride\listid20\listoverridecount0\ls20}{\listoverride\listid21\listoverridecount0\ls21}{\listoverride\listid22\listoverridecount0\ls22}{\listoverride\listid23\listoverridecount0\ls23}{\listoverride\listid24\listoverridecount0\ls24}{\listoverride\listid25\listoverridecount0\ls25}{\listoverride\listid26\listoverridecount0\ls26}{\listoverride\listid27\listoverridecount0\ls27}{\listoverride\listid28\listoverridecount0\ls28}{\listoverride\listid29\listoverridecount0\ls29}{\listoverride\listid30\listoverridecount0\ls30}{\listoverride\listid31\listoverridecount0\ls31}{\listoverride\listid32\listoverridecount0\ls32}{\listoverride\listid33\listoverridecount0\ls33}{\listoverride\listid34\listoverridecount0\ls34}{\listoverride\listid35\listoverridecount0\ls35}{\listoverride\listid36\listoverridecount0\ls36}}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\sa321\partightenfactor0

\f0\b\fs48 \cf0 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 AlbaniaVisit Tours \'97 Technical PRD (Astro + Claude Code)\
\pard\pardeftab720\sa240\partightenfactor0

\fs24 \cf0 Repo:
\f1\b0  
\f2\fs26 https://github.com/ezhulati/av-tours-ez
\f1\fs24 \uc0\u8232 
\f0\b Domain:
\f1\b0  
\f2\fs26 https://tours.albaniavisit.com
\f1\fs24 \uc0\u8232 
\f0\b Purpose:
\f1\b0  SEO-first affiliate tours site that 
\f0\b reads tours + images directly from the existing Supabase database
\f1\b0  (no rehosting), adds 
\f0\b server-side affiliate tracking
\f1\b0 , and ships a 
\f0\b fast, low-JS
\f1\b0  UX.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 0) Non-Negotiables\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls1\ilvl0
\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Astro + React islands
\f1\b0  (no Next.js).\
\ls1\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 DB is the source of truth
\f1\b0  for tours & images. Use 
\f0\b existing image URLs verbatim
\f1\b0 .\
\ls1\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Affiliate flow is server-side
\f1\b0 : all CTAs hit 
\f2\fs26 /out/[slug]
\f1\fs24  \uc0\u8594  click logged \u8594  inject 
\f2\fs26 partner_id=9&tid=albaniavisit
\f1\fs24  \uc0\u8594  
\f0\b 302
\f1\b0  to BNAdventure.\
\ls1\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 SSG for all canonical pages
\f1\b0 ; islands for interactivity (filters, gallery, inquiry).\
\ls1\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Deliverable
\f1\b0 : working site deployed on Netlify with analytics, sitemap, and JSON-LD in place.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 1) Platform & Tooling\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf0 Stack\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls2\ilvl0
\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Frontend:
\f1\b0  Astro (SSG) + React 18 islands, Tailwind CSS, shadcn/ui (via MCP server)\
\ls2\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Adapter/Hosting:
\f1\b0  Netlify Functions (
\f2\fs26 @astrojs/netlify/functions
\f1\fs24 )\
\ls2\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Data:
\f1\b0  Supabase (Postgres) \'97 reuse the 
\f0\b existing
\f1\b0  project with tours + images\
\ls2\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Search:
\f1\b0  Postgres FTS function 
\f2\fs26 search_tours(q text, lim int)
\f1\fs24 \
\ls2\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Email (inquiries):
\f1\b0  Resend (or SendGrid)\
\ls2\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Analytics:
\f1\b0  GA4\
\pard\pardeftab720\sa280\partightenfactor0

\f0\b\fs28 \cf0 \strokec2 Required Env (Netlify)\
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 SUPABASE_URL=...\
SUPABASE_SERVICE_ROLE_KEY=...     # server only\
RESEND_KEY=...                    # if inquiry emails enabled\
GA4_ID=G-XXXXXXXXXX\
REVALIDATE_SECRET=...             # optional\
\pard\pardeftab720\sa280\partightenfactor0

\f0\b\fs28 \cf0 Node & Package Manager\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls3\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Node 20.x, pnpm 9.x\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 2) Repository Bootstrap (Claude \'97 implement)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls4\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Initialize Astro project with Tailwind & Netlify adapter.\
\ls4\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Commit base config files and CI-ready 
\f2\fs26 netlify.toml
\f1\fs24 .\
\pard\pardeftab720\sa280\partightenfactor0

\f0\b\fs28 \cf0 \strokec2 Files to create\
\pard\pardeftab720\sa319\partightenfactor0

\f3\fs26 \cf0 \strokec2 package.json
\f0\fs24  (scripts)\
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 \strokec2 \{\
  "scripts": \{\
    "dev": "astro dev",\
    "build": "astro build",\
    "preview": "astro preview",\
    "lint": "eslint ."\
  \}\
\}\
\pard\pardeftab720\sa319\partightenfactor0

\f3\b \cf0 \strokec2 astro.config.mjs
\f0\fs24 \
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 \strokec2 import \{ defineConfig \} from 'astro/config'\
import react from '@astrojs/react'\
import tailwind from '@astrojs/tailwind'\
import sitemap from '@astrojs/sitemap'\
import netlify from '@astrojs/netlify/functions'\
\
export default defineConfig(\{\
  site: 'https://tours.albaniavisit.com',\
  output: 'server',\
  adapter: netlify(),\
  integrations: [react(), tailwind(), sitemap()]\
\})\
\pard\pardeftab720\sa319\partightenfactor0

\f3\b \cf0 \strokec2 netlify.toml
\f0\fs24 \
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 \strokec2 [build]\
  command = "pnpm build"\
  publish = "dist"\
\
[functions]\
  node_bundler = "esbuild"\
\
[[headers]]\
  for = "/*"\
  [headers.values]\
    Content-Security-Policy = "default-src 'self'; img-src 'self' data: https:; script-src 'self' https://www.googletagmanager.com; connect-src 'self' https://*.supabase.co; frame-ancestors 'none';"\
\
[[redirects]]\
  from = "/out/*"\
  to = "/api/out/:splat"\
  status = 200\
\pard\pardeftab720\sa319\partightenfactor0

\f3\b \cf0 \strokec2 .mcp.json
\f0\fs24  (shadcn MCP server)\
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 \strokec2 \{\
  "mcpServers": \{\
    "shadcn-ui": \{\
      "command": "npx",\
      "args": ["@jpisnice/shadcn-ui-mcp-server"],\
      "env": \{ "GITHUB_PERSONAL_ACCESS_TOKEN": "$\{GITHUB_PAT\}" \}\
    \}\
  \}\
\}\
\pard\pardeftab720\sa319\partightenfactor0

\f3\b \cf0 \strokec2 .claude/settings.json
\f0\fs24 \
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 \strokec2 \{\
  "permissions": \{\
    "allow": [\
      "Bash(pnpm *)",\
      "Bash(git *)",\
      "Write(src/**/*)",\
      "Write/scripts/**/*"\
    ]\
  \}\
\}\
\pard\pardeftab720\sa319\partightenfactor0

\f3\b \cf0 \strokec2 tsconfig.json
\f0\fs24  (alias)\
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 \strokec2 \{\
  "compilerOptions": \{\
    "baseUrl": ".",\
    "paths": \{ "@/*": ["src/*"] \},\
    "types": ["@types/node"],\
    "strict": true\
  \}\
\}\
\pard\pardeftab720\sa319\partightenfactor0

\f3\b \cf0 \strokec2 tailwind.config.cjs
\f0\fs24 \
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 \strokec2 module.exports = \{\
  content: ['./src/**/*.\{astro,html,js,jsx,ts,tsx\}'],\
  theme: \{ extend: \{\} \},\
  plugins: []\
\}\
\pard\pardeftab720\sa319\partightenfactor0

\f3\b \cf0 \strokec2 src/styles/global.css
\f0\fs24 \
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 \strokec2 @tailwind base;\
@tailwind components;\
@tailwind utilities;\
\
:root \{ --radius: 1rem; \}\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 3) Directory Layout\
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 src/\
\uc0\u9500 \u9472  components/\
\uc0\u9474   \u9500 \u9472  ui/                      # shadcn components (generated via MCP)\
\uc0\u9474   \u9492 \u9472  tours/                   # React islands\
\uc0\u9474      \u9500 \u9472  TourCard.tsx\
\uc0\u9474      \u9500 \u9472  FilterBar.tsx\
\uc0\u9474      \u9500 \u9472  TourGallery.tsx\
\uc0\u9474      \u9500 \u9472  BookingButton.tsx\
\uc0\u9474      \u9492 \u9472  InquiryForm.tsx\
\uc0\u9500 \u9472  layouts/\
\uc0\u9474   \u9492 \u9472  BaseLayout.astro\
\uc0\u9500 \u9472  lib/\
\uc0\u9474   \u9500 \u9472  supabase.server.ts       # service-role client (server only)\
\uc0\u9474   \u9500 \u9472  dto.ts                   # TourCardDTO, TourDetailDTO\
\uc0\u9474   \u9500 \u9472  adapters/\
\uc0\u9474   \u9474   \u9492 \u9472  dbMapper.ts           # map DB \u8594  DTO (configurable table/field names)\
\uc0\u9474   \u9500 \u9472  queries.ts               # server queries (SSG/APIs)\
\uc0\u9474   \u9500 \u9472  affiliate.ts             # `/out` helper\
\uc0\u9474   \u9492 \u9472  seo.ts                   # JSON-LD builders\
\uc0\u9500 \u9472  pages/\
\uc0\u9474   \u9500 \u9472  index.astro\
\uc0\u9474   \u9500 \u9472  tours/index.astro\
\uc0\u9474   \u9500 \u9472  tours/[slug].astro\
\uc0\u9474   \u9500 \u9472  country/[code].astro\
\uc0\u9474   \u9500 \u9472  category/[slug].astro\
\uc0\u9474   \u9492 \u9472  api/\
\uc0\u9474      \u9500 \u9472  tours.ts\
\uc0\u9474      \u9500 \u9472  tours/[slug].ts\
\uc0\u9474      \u9500 \u9472  search.ts\
\uc0\u9474      \u9500 \u9472  inquiries.ts\
\uc0\u9474      \u9500 \u9472  revalidate.ts\
\uc0\u9474      \u9492 \u9472  out/[slug].ts\
\uc0\u9492 \u9472  styles/global.css\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 4) Data Contracts & DB Mapping\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf0 DTOs (UI contract)\
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 export type Difficulty = 'easy'|'moderate'|'challenging'|'difficult'\
\
export interface TourCardDTO \{\
  id: string\
  slug: string\
  title: string\
  shortDescription: string | null\
  priceMin: number | null\
  priceMax: number | null\
  currency: 'EUR'|'USD'|'GBP'\
  durationDays: number | null\
  durationDisplay: string | null\
  difficulty: Difficulty | null\
  primaryImageUrl: string\
  countries: string[]\
  categorySlugs: string[]\
  featured: boolean\
\}\
\
export interface TourDetailDTO extends TourCardDTO \{\
  fullDescription: string | null\
  inclusions: string[]\
  exclusions: string[]\
  departureNotes: string | null\
  images: \{ url: string; alt: string|null; width?: number; height?: number \}[]\
  operator: \{ id: string; name: string; slug: string; logoUrl?: string|null \} | null\
  affiliateUrl: string\
\}\
\pard\pardeftab720\sa280\partightenfactor0

\f0\b\fs28 \cf0 DB Adapter (
\f3\fs30\fsmilli15210 lib/adapters/dbMapper.ts
\f0\fs28 )\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls5\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Reads from 
\f0\b existing tables
\f1\b0  (names may be 
\f2\fs26 tours
\f1\fs24  or 
\f2\fs26 affiliate_tours
\f1\fs24 , etc.).\
\ls5\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Config:\
\pard\pardeftab720\partightenfactor0

\f2\fs26 \cf0 \strokec2 export const TABLES = \{\
  tours: 'tours',                // or 'affiliate_tours'\
  images: 'tour_images',\
  categories: 'tour_categories',\
  countries: 'tour_countries',\
  operators: 'tour_operators',\
  clicks: 'affiliate_clicks',\
  inquiries: 'inquiries'\
\}\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls6\ilvl0
\f1\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Map fields (support 
\f2\fs26 price_from
\f1\fs24  or 
\f2\fs26 price
\f1\fs24  fields; 
\f2\fs26 duration_days
\f1\fs24  or 
\f2\fs26 duration
\f1\fs24  strings).\
\ls6\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Never rewrite 
\f3\fs26 primary_image_url
\f0\fs24  or gallery 
\f3\fs26 url
\f1\b0\fs24 ; pass through verbatim.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 5) Database Requirements\
\pard\pardeftab720\sa240\partightenfactor0

\f4\i\b0\fs24 \cf0 \strokec2 (Reuse existing content DB; add only what\'92s missing for search/clicks/inquiries.)
\f1\i0 \strokec2 \
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 affiliate_clicks
\f0\fs28  (if missing)\
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 create table if not exists affiliate_clicks (\
  id uuid primary key default gen_random_uuid(),\
  created_at timestamptz default now(),\
  tour_id uuid references tours(id),\
  operator_id uuid,\
  source_url text,\
  outbound_url text not null,\
  ip inet,\
  ua text,\
  referer text,\
  utm jsonb\
);\
create index if not exists idx_clicks_tour_created on affiliate_clicks(tour_id, created_at);\
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 inquiries
\f0\fs28  (if missing)\
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 create table if not exists inquiries (\
  id uuid primary key default gen_random_uuid(),\
  created_at timestamptz default now(),\
  tour_id uuid references tours(id),\
  name text not null,\
  email text not null,\
  phone text,\
  preferred_date date,\
  participants int,\
  message text,\
  utm jsonb\
);\
create index if not exists idx_inquiries_tour_created on inquiries(tour_id, created_at);\
\pard\pardeftab720\sa280\partightenfactor0

\f0\b\fs28 \cf0 FTS on 
\f3\fs30\fsmilli15210 tours
\f0\fs28  (or 
\f3\fs30\fsmilli15210 affiliate_tours
\f0\fs28 )\
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 alter table tours add column if not exists tsv tsvector;\
create index if not exists idx_tours_tsv on tours using gin(tsv);\
update tours set tsv = to_tsvector('simple', coalesce(title,'') || ' ' || coalesce(short_description,''));\
\
create or replace function tours_tsv_update() returns trigger language plpgsql as $$\
begin\
  new.tsv := to_tsvector('simple', coalesce(new.title,'') || ' ' || coalesce(new.short_description,''));\
  return new;\
end$$;\
drop trigger if exists tours_tsv_update_trg on tours;\
create trigger tours_tsv_update_trg before insert or update on tours\
for each row execute function tours_tsv_update();\
\
create or replace function public.search_tours(q text, lim int default 10)\
returns table(slug text, title text, snippet text)\
language sql as $$\
  select slug, title, left(coalesce(short_description,''), 180) as snippet\
  from tours\
  where status='active' and tsv @@ plainto_tsquery('simple', q)\
  order by ts_rank(tsv, plainto_tsquery('simple', q)) desc\
  limit lim\
$$;\
\pard\pardeftab720\sa240\partightenfactor0

\f1\fs24 \cf0 If production table is 
\f2\fs26 affiliate_tours
\f1\fs24 , create equivalent 
\f2\fs26 tsv
\f1\fs24 /RPC there and target it in 
\f2\fs26 queries.ts
\f1\fs24 .\
\pard\pardeftab720\sa280\partightenfactor0

\f0\b\fs28 \cf0 RLS\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls7\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Public read via 
\f0\b server
\f1\b0  (service role). No client writes except through API routes.\
\ls7\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Optionally allow 
\f2\fs26 anon
\f1\fs24  
\f0\b INSERT only
\f1\b0  on 
\f2\fs26 affiliate_clicks
\f1\fs24  & 
\f2\fs26 inquiries
\f1\fs24  via API or SECURITY DEFINER RPC.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 6) API Surface (Astro APIRoute)\
\pard\pardeftab720\sa240\partightenfactor0

\f1\b0\fs24 \cf0 All handlers use 
\f2\fs26 lib/supabase.server.ts
\f1\fs24  (service-role server-only client).\
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 GET /api/tours
\f0\fs28 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls8\ilvl0
\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Query params:
\f1\b0  
\f2\fs26 page
\f1\fs24 , 
\f2\fs26 limit
\f1\fs24 , 
\f2\fs26 country
\f1\fs24 , 
\f2\fs26 category
\f1\fs24 , 
\f2\fs26 difficulty
\f1\fs24 , 
\f2\fs26 price_min
\f1\fs24 , 
\f2\fs26 price_max
\f1\fs24 , 
\f2\fs26 duration_min
\f1\fs24 , 
\f2\fs26 duration_max
\f1\fs24 , 
\f2\fs26 sort
\f1\fs24  (price|duration|newest|popular).\
\ls8\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Response:
\f1\b0 \
\pard\pardeftab720\partightenfactor0

\f2\fs26 \cf0 \strokec2 \{\
  "items": [/* TourCardDTO subset */],\
  "pagination": \{ "page": 1, "limit": 12, "total": 72 \}\
\}\
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 GET /api/tours/[slug]
\f0\fs28 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls9\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Returns full 
\f0\b TourDetailDTO
\f1\b0 .\
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 \strokec2 GET /api/search?q=...
\f0\fs28 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls10\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Calls 
\f2\fs26 search_tours
\f1\fs24  RPC; returns 
\f2\fs26 \{ suggestions: string[], items: \{slug,title,snippet\}[] \}
\f1\fs24 .\
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 \strokec2 POST /api/inquiries
\f0\fs28 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls11\ilvl0
\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Body:
\f1\b0  
\f2\fs26 \{ tourId, name, email, phone?, preferredDate?, participants?, message?, utm? \}
\f1\fs24 \
\ls11\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Inserts into 
\f2\fs26 inquiries
\f1\fs24 ; optional email via Resend; returns 
\f2\fs26 \{ ok: true, id \}
\f1\fs24 .\
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 \strokec2 GET /api/out/[slug]
\f0\fs28 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls12\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Resolve tour by slug \uc0\u8594  base 
\f2\fs26 affiliate_url
\f1\fs24 .\
\ls12\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Inject 
\f2\fs26 partner_id=9&tid=albaniavisit&src=/tours/[slug]
\f1\fs24  (idempotent).\
\ls12\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Insert row into 
\f2\fs26 affiliate_clicks
\f1\fs24 .\
\ls12\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Set 
\f2\fs26 /_aff
\f1\fs24  cookie (90d, HttpOnly, Lax).\
\ls12\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 302
\f1\b0  redirect to outbound affiliate URL.\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 7) Pages (SSG) & Routing\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf0 URL structure\
\pard\pardeftab720\partightenfactor0

\f2\b0\fs26 \cf0 /                      # Home (featured)\
/tours                 # Listing (paginated)\
/tours/[slug]          # Tour detail\
/country/[code]        # AL | XK | ME | MK\
/category/[slug]       # hiking-trekking, cultural, winter...\
/out/[slug]            # affiliate server redirect\
\pard\pardeftab720\sa280\partightenfactor0

\f0\b\fs28 \cf0 SSG\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls13\ilvl0
\f2\b0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 getStaticPaths
\f1\fs24  for 
\f2\fs26 /tours/[slug]
\f1\fs24  using 
\f2\fs26 queries.getAllSlugs()
\f1\fs24  (active tours).\
\ls13\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Home + 
\f2\fs26 /tours
\f1\fs24  prerender page 1; filters resolved via API + island.\
\pard\pardeftab720\sa280\partightenfactor0

\f0\b\fs28 \cf0 \strokec2 JSON-LD\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls14\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Detail: 
\f2\fs26 TouristTrip
\f1\fs24 ; site: 
\f2\fs26 Organization
\f1\fs24 ; breadcrumbs: 
\f2\fs26 BreadcrumbList
\f1\fs24 .\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 8) Components (React islands, shadcn via MCP)\
\pard\pardeftab720\sa240\partightenfactor0

\f1\b0\fs24 \cf0 Claude: fetch 
\f0\b Card, Badge, Button, Tabs, Dialog, Sheet, Select, Checkbox, Slider, Separator, Carousel, AspectRatio, Skeleton
\f1\b0  into 
\f2\fs26 src/components/ui/*
\f1\fs24 .\
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 TourCard.tsx
\f0\fs28 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls15\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Props: 
\f2\fs26 \{ tour: TourCardDTO \}
\f1\fs24 \
\ls15\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 4:3 image (
\f2\fs26 tour.primaryImageUrl
\f1\fs24 , 
\f2\fs26 object-cover
\f1\fs24 ), title, 
\f0\b price badge
\f1\b0  (
\f2\fs26 From \'80X
\f1\fs24  if 
\f2\fs26 priceMin
\f1\fs24 ), duration, difficulty, country chips\
\ls15\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 CTA \uc0\u8594  
\f2\fs26 href="/out/$\{tour.slug\}"
\f1\fs24  with 
\f2\fs26 rel="sponsored nofollow noopener"
\f1\fs24 \
\ls15\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Include a skeleton variant\
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 \strokec2 FilterBar.tsx
\f0\fs28 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls16\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Activity checkboxes, difficulty select, duration slider (1\'9614), location multi-select, price range slider\
\ls16\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Writes query params to URL and calls 
\f2\fs26 /api/tours
\f1\fs24  (debounced) to refresh grid\
\ls16\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Mobile: 
\f2\fs26 Sheet
\f1\fs24  overlay\
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 \strokec2 TourGallery.tsx
\f0\fs28 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls17\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Carousel + Dialog lightbox, arrow keys, thumbnails, 
\f0\b no CLS
\f1\b0  (AspectRatio wrapper)\
\ls17\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Use DB URLs verbatim\
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 \strokec2 InquiryForm.tsx
\f0\fs28 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls18\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 zod validation; POST 
\f2\fs26 /api/inquiries
\f1\fs24 \
\ls18\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Hidden fields: captured UTM; 
\f2\fs26 /_aff
\f1\fs24  cookie value if present\
\ls18\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Success toast, reset; disabled while pending\
\pard\pardeftab720\sa280\partightenfactor0

\f3\b\fs30\fsmilli15210 \cf0 \strokec2 BookingButton.tsx
\f0\fs28 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls19\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Always points to 
\f2\fs26 /out/[slug]
\f1\fs24 , tracks GA event 
\f2\fs26 affiliate_click
\f1\fs24 \
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 9) SEO & Analytics\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls20\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Title template: 
\f2\fs26 \{Tour Name\} | \{Duration\} Days | From \'80\{priceMin\}
\f1\fs24  (omit price if null)\
\ls20\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Meta descriptions from 
\f2\fs26 shortDescription
\f1\fs24  (~155 chars)\
\ls20\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 OpenGraph image = 
\f2\fs26 primaryImageUrl
\f1\fs24 \
\ls20\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 JSON-LD via 
\f2\fs26 seo.ts
\f1\fs24 \
\ls20\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Sitemap via 
\f2\fs26 @astrojs/sitemap
\f1\fs24 \
\ls20\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 GA4 events:\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls20\ilvl1
\f2\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 affiliate_click
\f1\fs24  
\f2\fs26 \{ tour_id, tour_slug, tour_title \}
\f1\fs24 \
\ls20\ilvl1
\f2\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 filter_apply
\f1\fs24  
\f2\fs26 \{ filters \}
\f1\fs24 \
\ls20\ilvl1
\f2\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 search_submit
\f1\fs24  
\f2\fs26 \{ q, results_count \}
\f1\fs24 \
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 10) Performance Budgets\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls21\ilvl0
\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 LCP < 2.0s
\f1\b0  on detail pages (hero image in HTML)\
\ls21\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 CLS = 0
\f1\b0  (AspectRatio wrappers; width/height when known)\
\ls21\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Shipped JS per page 
\f0\b < 50 KB
\f1\b0  (islands only)\
\ls21\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Images: serve from DB as-is; 
\f2\fs26 loading="lazy"
\f1\fs24  below fold; 
\f2\fs26 decoding="async"
\f1\fs24 \
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 11) Security\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls22\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Service-role key used 
\f0\b only on server
\f1\b0 ; never in client bundles\
\ls22\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Inquiries contain PII \uc0\u8594  do 
\f0\b not
\f1\b0  log full body\
\ls22\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 All affiliate anchors use 
\f2\fs26 rel="sponsored nofollow noopener"
\f1\fs24 \
\ls22\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 CSP header as in 
\f2\fs26 netlify.toml
\f1\fs24 \
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 12) Claude Code \'97 Concrete Tasks & Prompts\
\pard\pardeftab720\sa240\partightenfactor0

\fs24 \cf0 Task 0 \'97 Repo init
\f1\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls23\ilvl0
\f2\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 pnpm create astro@latest .
\f1\fs24  (minimal), add React, Tailwind, Sitemap, Netlify adapter\
\ls23\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Commit base config files above\
\pard\pardeftab720\sa240\partightenfactor0

\f0\b \cf0 \strokec2 Task 1 \'97 shadcn MCP setup
\f1\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls24\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Ensure 
\f2\fs26 .mcp.json
\f1\fs24  & 
\f2\fs26 .claude/settings.json
\f1\fs24 \
\ls24\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Prompt:\
\pard\pardeftab720\sa240\partightenfactor0
\cf0 Using the shadcn-ui MCP server, fetch Card, Badge, Button, Tabs, Dialog, Sheet, Select, Checkbox, Slider, Separator, Carousel, AspectRatio, Skeleton and scaffold them into 
\f2\fs26 src/components/ui/
\f1\fs24  for React 18 + Tailwind.\strokec2 \
\pard\pardeftab720\sa240\partightenfactor0

\f0\b \cf0 Task 2 \'97 Supabase server client
\f1\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls25\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Create 
\f2\fs26 lib/supabase.server.ts
\f1\fs24 :\
\pard\pardeftab720\partightenfactor0

\f2\fs26 \cf0 \strokec2 import \{ createClient \} from '@supabase/supabase-js'\
const url = import.meta.env.SUPABASE_URL!\
const key = import.meta.env.SUPABASE_SERVICE_ROLE_KEY!\
export const supabaseServer = createClient(url, key, \{ auth: \{ persistSession: false \} \})\
\pard\pardeftab720\sa240\partightenfactor0

\f0\b\fs24 \cf0 Task 3 \'97 DTOs & DB mapper
\f1\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls26\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Implement DTOs and 
\f2\fs26 adapters/dbMapper.ts
\f1\fs24  to handle 
\f2\fs26 tours
\f1\fs24  
\f0\b or
\f1\b0  
\f2\fs26 affiliate_tours
\f1\fs24 \
\ls26\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Implement 
\f2\fs26 queries.ts
\f1\fs24 :\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls26\ilvl1
\f2\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 getAllSlugs()
\f1\fs24 \
\ls26\ilvl1
\f2\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 getTourCardPage(params)
\f1\fs24 \
\ls26\ilvl1
\f2\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 getTourDetail(slug)
\f1\fs24 \
\pard\pardeftab720\sa240\partightenfactor0

\f0\b \cf0 \strokec2 Task 4 \'97 API routes
\f1\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls27\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Create all API handlers in 
\f2\fs26 pages/api/*
\f1\fs24  per section 6\
\pard\pardeftab720\sa240\partightenfactor0

\f0\b \cf0 \strokec2 Task 5 \'97 Pages
\f1\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls28\ilvl0
\f2\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 BaseLayout.astro
\f1\fs24  with GA4 and canonical tags\
\ls28\ilvl0
\f2\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 pages/tours/index.astro
\f1\fs24  + 
\f2\fs26 pages/tours/[slug].astro
\f1\fs24  (with 
\f2\fs26 getStaticPaths
\f1\fs24 )\
\ls28\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Country/category pages prefilter server-side (SSG) and reuse 
\f2\fs26 TourCard
\f1\fs24 \
\pard\pardeftab720\sa240\partightenfactor0

\f0\b \cf0 \strokec2 Task 6 \'97 Islands
\f1\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls29\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Implement 
\f2\fs26 TourCard
\f1\fs24 , 
\f2\fs26 FilterBar
\f1\fs24 , 
\f2\fs26 TourGallery
\f1\fs24 , 
\f2\fs26 InquiryForm
\f1\fs24 , 
\f2\fs26 BookingButton
\f1\fs24  as specified\
\ls29\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Hook up events, API calls, accessibility (focus traps in dialogs)\
\pard\pardeftab720\sa240\partightenfactor0

\f0\b \cf0 \strokec2 Task 7 \'97 SEO
\f1\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls30\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Add JSON-LD via 
\f2\fs26 seo.ts
\f1\fs24 ; verify sitemap & robots\
\pard\pardeftab720\sa240\partightenfactor0

\f0\b \cf0 \strokec2 Task 8 \'97 Affiliate
\f1\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls31\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Implement 
\f2\fs26 /api/out/[slug]
\f1\fs24  redirect logic with cookie and DB insert\
\ls31\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Ensure every \'93Book / Check Availability\'94 button uses this internal route\
\pard\pardeftab720\sa240\partightenfactor0

\f0\b \cf0 \strokec2 Task 9 \'97 Smoke tests (minimal)
\f1\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls32\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Playwright (optional): list \uc0\u8594  detail \u8594  
\f2\fs26 /out
\f1\fs24  302 assertion\
\ls32\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Vitest unit: affiliate URL injector (idempotent; merges params)\
\pard\pardeftab720\sa240\partightenfactor0

\f0\b \cf0 \strokec2 Task 10 \'97 Docs
\f1\b0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls33\ilvl0\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Create 
\f2\fs26 CLAUDE.md
\f1\fs24  summarizing commands, architecture, and common tasks\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 13) Acceptance Criteria\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls34\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u9989  All live tours render with content & images from the DB; 
\f0\b no missing images
\f1\b0 , 
\f0\b no layout shift
\f1\b0  in galleries/cards\
\ls34\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u9989  
\f2\fs26 /out/[slug]
\f1\fs24  logs clicks, injects 
\f2\fs26 partner_id=9&tid=albaniavisit
\f1\fs24 , sets cookie, and 302 redirects\
\ls34\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u9989  
\f2\fs26 /api/search
\f1\fs24  responds \uc0\u8804  200 ms (warm) for common queries\
\ls34\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u9989  Filters update results and URL; deep links with filters restore state\
\ls34\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u9989  JSON-LD validates for detail pages; sitemap includes all slugs\
\ls34\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u9989  LCP < 2.0s, CLS = 0, shipped JS/page < 50 KB\
\ls34\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 \uc0\u9989  CSP present; no mixed content; service role key not shipped client-side\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 14) Troubleshooting Notes\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls35\ilvl0
\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Images 404/broken:
\f1\b0  confirm DB URLs; never import into 
\f2\fs26 /public
\f1\fs24 ; use AspectRatio wrappers to avoid CLS\
\ls35\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Blank detail page:
\f1\b0  slug mismatch or 
\f2\fs26 status != active
\f1\fs24 ; check 
\f2\fs26 /api/tours/[slug]
\f1\fs24 \
\ls35\ilvl0
\f0\b \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Affiliate not tracking:
\f1\b0  CTA must point to 
\f2\fs26 /out/[slug]
\f1\fs24 ; verify 
\f2\fs26 affiliate_clicks
\f1\fs24  insert and injected params\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f0\b\fs36 \cf0 \strokec2 15) Nice-to-Have (Post-MVP)\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls36\ilvl0
\f1\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Algolia or pgvector semantic search\
\ls36\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Favorites (localStorage)\
\ls36\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 A/B testing for hero/CTA copy\
\ls36\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 axe-core a11y checks in CI\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa280\partightenfactor0

\f0\b\fs28 \cf0 \strokec2 Final Note for Claude\
\pard\pardeftab720\sa240\partightenfactor0

\f1\b0\fs24 \cf0 Prefer 
\f0\b server joins & filtering
\f1\b0  in Supabase over client aggregation. Keep Astro pages as light shells; use islands only where interaction is required. Use the 
\f0\b shadcn MCP
\f1\b0  to stay consistent with design tokens and accelerate component generation.\
}